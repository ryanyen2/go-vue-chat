(function(e){function t(t){for(var s,a,o=t[0],c=t[1],l=t[2],d=0,m=[];d<o.length;d++)a=o[d],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&m.push(r[a][0]),r[a]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);u&&u(t);while(m.length)m.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],s=!0,o=1;o<n.length;o++){var c=n[o];0!==r[c]&&(s=!1)}s&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var s={},r={app:0},i=[];function a(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=s,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(n,s,function(t){return e[t]}.bind(null,s));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},1:function(e,t){},1155:function(e,t,n){"use strict";n("47fa")},"47fa":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var s=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",[n("v-main",[n("NavBar")],1)],1)},i=[],a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",{staticClass:"overflow-hidden"},[n("v-app-bar",{attrs:{absolute:"",color:"#161B22","hide-on-scroll":"","scroll-target":"#scrolling-techniques-3"}},[n("v-app-bar-nav-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),n("v-app-bar-title",[e._v("Socket-Chat")]),n("v-spacer"),n("v-btn",{attrs:{icon:""}},[n("v-icon",[e._v("mdi-cog")])],1),n("v-btn",{attrs:{icon:""}},[n("v-icon",[e._v("mdi-dots-vertical")])],1)],1),n("v-sheet",{staticClass:"overflow-y-auto",attrs:{id:"scrolling-techniques-3","max-height":"1000"}},[n("v-container",{staticStyle:{"margin-top":"6rem"}},[n("router-view")],1)],1),n("v-navigation-drawer",{attrs:{absolute:"",bottom:"",temporary:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[n("v-list",{attrs:{nav:"",dense:""}},[n("v-list-item-group",{attrs:{"active-class":"deep-purple--text text--accent-4"},model:{value:e.group,callback:function(t){e.group=t},expression:"group"}},[n("v-list-item",[n("v-list-item-title",[e._v("Chat")])],1),n("v-list-item",[n("v-list-item-title",[e._v("TextArea")])],1),n("v-list-item",[n("v-list-item-title",[e._v("Data Collection")])],1)],1)],1)],1)],1)},o=[],c={name:"NavBar",components:{},data:function(){return{drawer:!1,group:null}},watch:{group:function(){this.drawer=!1}}},l=c,u=n("2877"),d=n("6544"),m=n.n(d),p=n("40dc"),g=n("5bc1"),h=n("bb78"),f=n("8336"),v=n("b0af"),b=n("a523"),w=n("132d"),y=n("8860"),C=n("da13"),k=n("1baa"),x=n("5d23"),S=n("f774"),_=n("8dd9"),V=n("2fa4"),O=Object(u["a"])(l,a,o,!1,null,"c98f6aa6",null),T=O.exports;m()(O,{VAppBar:p["a"],VAppBarNavIcon:g["a"],VAppBarTitle:h["a"],VBtn:f["a"],VCard:v["a"],VContainer:b["a"],VIcon:w["a"],VList:y["a"],VListItem:C["a"],VListItemGroup:k["a"],VListItemTitle:x["a"],VNavigationDrawer:S["a"],VSheet:_["a"],VSpacer:V["a"]});var j={name:"App",components:{NavBar:T},data:function(){return{}}},U=j,E=n("7496"),A=n("f6c4"),L=Object(u["a"])(U,r,i,!1,null,null,null),R=L.exports;m()(L,{VApp:E["a"],VMain:A["a"]});var B=n("f309");s["a"].use(B["a"]);var N=new B["a"]({theme:{dark:!0}}),M=n("8c4f"),q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-row",{staticStyle:{display:"block"}},[n("v-card",{staticClass:"overflow-hidden"},[n("v-app-bar",{attrs:{absolute:"",color:"#212D3B","hide-on-scroll":"","scroll-target":"#scrolling-techniques-4"}},[n("v-toolbar-title",[e._v("Chat History")]),n("v-spacer"),n("v-btn",{attrs:{icon:""}},[n("v-icon",[e._v("mdi-share")])],1)],1),n("v-sheet",{staticClass:"overflow-y-auto",attrs:{id:"scrolling-techniques-4","max-height":"500"}},[n("v-container",{staticStyle:{height:"1000px","background-color":"#151E27"}},[n("MessageUnit",{attrs:{messages:e.messages,selfUserName:this.currentUser.username}})],1)],1),n("v-row",{staticClass:"pt-5 pl-3 pr-3",staticStyle:{"background-color":"#212D3B"}},[n("v-col",{attrs:{cols:"8"}},[n("v-text-field",{attrs:{label:"Message",outlined:""},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.send(t)}},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}})],1),n("v-spacer"),n("v-col",{staticClass:"text-right",attrs:{cols:"4"}},[n("v-btn",{staticClass:"mr-3",attrs:{large:"",outlined:"",color:e.isSpeaking?"#5B438D":"#3572A5"},on:{click:this.audioInput}},[e._v(" "+e._s(e.isSpeaking?"Stop Audio":"Start Audio")+" "),e.isSpeaking?n("v-icon",{attrs:{right:""}},[e._v(" mdi-microphone-off")]):n("v-icon",{attrs:{right:""}},[e._v("mdi-microphone")])],1),n("v-btn",{staticClass:"mr-2",attrs:{medium:"",fab:"",color:"#3572A5"},on:{click:e.send}},[n("v-icon",[e._v("mdi-send")])],1)],1)],1)],1)],1)],1)},I=[],P=n("5530"),$=(n("d81d"),n("d4ec")),J=n("bee2"),D=n("2bd2"),H=H||webkitSpeechRecognition,F=function(){function e(){var t=this;Object($["a"])(this,e),this.recognition=new H,this.result="created",this.resultSubject=new D["a"],this.recognition.lang="en-EN",this.recognition.interimResults=!1,this.recognition.maxAlternatives=1,this.recognition.onresult=function(e){console.log("Event",e);var n=e.results.length-1;t.result=e.results[n][0].transcript,console.log("Confidence: ".concat(e.results[0][0].confidence),t.result),t.resultSubject.next(t.result)},this.recognition.onspeechend=function(){t.recognition.stop(),console.log("Speech end"),t.resultSubject.next("")},this.recognition.onnomatch=function(){console.log("I didn't recognise that colors.")},this.recognition.onerror=function(e){console.log("Error occurred in recognition: ".concat(e.error)),t.resultSubject.error("Error occurred in recognition: ".concat(e.error))}}return Object(J["a"])(e,[{key:"speak",value:function(){return this.recognition.start(),this.resultSubject}}]),e}(),z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"chat"},[n("div",{staticClass:"chat-history"},[e.messages?n("ul",e._l(e.messages,(function(t){return n("li",{key:t.sender,staticClass:"clearfix"},[n("div",{class:e.selfUserName===t.sender?"align-right message-data":"message-data"},[n("span",{staticClass:"message-data-time"},[e._v(" "+e._s(t.time))]),e._v(" "),n("span",{staticClass:"message-data-name"},[e._v(e._s(t.sender))]),n("i",{staticClass:"fa fa-circle me"})]),n("div",{class:e.selfUserName===t.sender?"message my-message float-right":"message other-message"},[e._v(" "+e._s(t.content)+" ")])])})),0):e._e()])])},G=[],W={name:"MessageUnit",props:{messages:Array,selfUserName:String},watch:{messages:function(){var e=document.querySelector(".chat");e.scrollTo(0,e.scrollHeight)}},mounted:function(){console.log("Messages: ",this.messages,"\tUserName: ",this.selfUserName)}},Y=W,K=(n("1155"),Object(u["a"])(Y,z,G,!1,null,"4377fd92",null)),Q=K.exports,X=n("5a0c"),Z=n.n(X),ee=n("2f62"),te={name:"ChatBody",components:{MessageUnit:Q},computed:Object(P["a"])({},Object(ee["b"])("auth",["getCurrentUser"])),data:function(){return{ws:null,message:null,currentUser:null,participants:[],messages:[{sender:"default",sender_email:"r@g.com",content:"This is the default content",time:"2021-03-26"}],isSpeaking:!1,speechService:{}}},methods:{send:function(){""!==this.message&&(this.ws.send(JSON.stringify({username:this.currentUser.username,message:this.message,timestamp:Z()()})),this.message="")},audioInput:function(){var e=this;this.isSpeaking=!0,this.speechService.speak().subscribe((function(t){e.isSpeaking=!1,e.message=t,console.log("Result",t)}),(function(t){console.error(t),e.isSpeaking=!1}),(function(){e.isSpeaking=!1})),console.log("speechService started")}},mounted:function(){var e=this;this.ws=new WebSocket("wss://"+window.location.host+"/wss"),this.ws.addEventListener("message",(function(t){var n=JSON.parse(t.data),s=!1;e.participants.map((function(e){e.username===n.username&&(s=!0)})),s||e.participants.push({email:n.email,username:n.username}),e.messages.push({sender:n.username,sender_email:n.email,content:n.message,time:n.timestamp})})),this.currentUser=this.getCurrentUser},created:function(){this.speechService=new F}},ne=te,se=n("62ad"),re=n("0fd9"),ie=n("8654"),ae=n("2a7f"),oe=Object(u["a"])(ne,q,I,!1,null,"1f21bbe5",null),ce=oe.exports;m()(oe,{VAppBar:p["a"],VBtn:f["a"],VCard:v["a"],VCol:se["a"],VContainer:b["a"],VIcon:w["a"],VRow:re["a"],VSheet:_["a"],VSpacer:V["a"],VTextField:ie["a"],VToolbarTitle:ae["a"]});var le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-card",[n("v-card-text",[n("v-form",[n("v-row",[n("v-col",{attrs:{cols:"4"}},[n("v-text-field",{attrs:{label:"Email",outlined:""},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),n("v-col",{attrs:{cols:"4"}},[n("v-text-field",{attrs:{label:"Username",outlined:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),n("v-col",{attrs:{cols:"3"}},[n("v-radio-group",{model:{value:e.role,callback:function(t){e.role=t},expression:"role"}},[n("v-radio",{attrs:{label:"Admin",value:"admin"}}),n("v-radio",{attrs:{label:"Experimenter",value:"experimenter"}}),n("v-radio",{attrs:{label:"Participant",value:"participant"}})],1)],1),n("v-col",{staticClass:"ma-2",attrs:{cols:"1"}},[n("v-btn",{attrs:{color:"#3E6189",large:""},on:{click:function(t){return e.join()}}},[n("v-icon",[e._v("mdi-account-plus")]),e._v(" Join ")],1)],1)],1)],1)],1)],1)},ue=[],de={name:"LoginForm",data:function(){return{email:null,username:null,role:null}},methods:Object(P["a"])(Object(P["a"])({},Object(ee["c"])("auth",["setCurrentUser"])),{},{join:function(){this.email?this.username?(this.setCurrentUser({email:this.email,username:this.username,role:this.role,createdAt:Z()()}),this.$router.push("text")):alert("You must choose a username"):alert("You must enter an email")}})},me=de,pe=n("99d9"),ge=n("4bd4"),he=n("67b6"),fe=n("43a6"),ve=Object(u["a"])(me,le,ue,!1,null,"74cf0078",null),be=ve.exports;m()(ve,{VBtn:f["a"],VCard:v["a"],VCardText:pe["a"],VCol:se["a"],VForm:ge["a"],VIcon:w["a"],VRadio:he["a"],VRadioGroup:fe["a"],VRow:re["a"],VTextField:ie["a"]});var we=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",["participant"===e.currentRole?n("v-row",[n("v-btn",{class:{"animated infinite pulse":e.isTesting},attrs:{icon:"",color:e.isTesting?e.isSpeaking?"red":"red darken-3":"grey"},on:{click:function(t){t.stopPropagation(),e.isTesting?e.endSpeechRecognition():e.startSpeechRecognition()}}},[n("v-icon",[e._v(e._s(e.isTesting?"mdi-microphone-off":"mdi-microphone"))])],1),n("div",[n("v-text-field",{model:{value:e.runTimeContent,callback:function(t){e.runTimeContent=t},expression:"runTimeContent"}})],1)],1):e._e(),"experimenter"===e.currentRole?n("div",{staticClass:"text-area",on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.wizardAddComment(t)}}},[n("quill-editor",{ref:"myTextEditor",staticClass:"editor",attrs:{value:e.content,options:e.editorOption},on:{change:e.onEditorChange}})],1):n("div",{staticClass:"text-area"},[n("quill-editor",{ref:"myBubbleEditor",staticClass:"editor",attrs:{content:e.content,options:e.bubbleEditorOption},on:{change:function(t){return e.onEditorChange(t)}}})],1)],1)},ye=[],Ce=(n("ac1f"),n("5319"),n("a15b"),n("a630"),n("3ca3"),n("1276"),n("b047")),ke=n.n(Ce),xe=n("953d"),Se=(n("a753"),n("8096"),{name:"TextArea",components:{quillEditor:xe["quillEditor"]},data:function(){return{ws:null,editorOption:{modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{color:[]},{background:[]}],[{align:[]}],["clean"],["link","image","video"]]}},bubbleEditorOption:{theme:"bubble",placeholder:"every content，support html",modules:{toolbar:[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["link","image"],["clean"]]}},content:"",sentences:[],isTesting:!1,isSpeaking:!1,recognition:null,runTimeContent:"",keywords:"however but and because whenever whereas thus yet"}},watch:{sentences:function(e){console.log(e),this.content+=e[e.length-1].content}},methods:{onEditorChange:ke()((function(e){this.content=e.html,this.content=this.content.replace(/<p>/g," "),this.content=this.content.replace(/<\/p>/g," "),this.content="<p>"+this.content+"</p>",console.log(this.content)}),466),wizardAddComment:function(){this.ws.send(JSON.stringify({type:"modification",username:this.getCurrentUser.username,message:this.content,timestamp:Z()()}))},startSpeechRecognition:function(){var e=this;this.isTesting=!0,this.recognition.onspeechstart=function(){console.log("Speech Start"),e.isSpeaking=!0},this.recognition.onspeechend=function(){console.log("Speech End"),e.isSpeaking=!1},this.recognition.onresult=function(t){e.runTimeContent=Array.from(t.results).map((function(e){return e[0]})).map((function(e){return e.transcript})).join("")},this.recognition.onend=function(){""!==e.runTimeContent&&(e.ws.send(JSON.stringify({type:"sentence",username:e.getCurrentUser.username,message:e.runTimeContent,timestamp:Z()()})),e.runTimeContent=""),e.recognition.stop(),e.isTesting&&e.recognition.start()},this.recognition.start()},endSpeechRecognition:function(){console.log("Stopped",this.recognition),this.isTesting=!1,this.recognition.stop()},preProcessContent:function(){}},computed:Object(P["a"])(Object(P["a"])({editor:function(){return this.$refs.myTextEditor.quill},keywordList:function(){return this.keywords.split(" ")}},Object(ee["b"])("auth",["getCurrentUser"])),{},{currentRole:function(){return this.getCurrentUser.role}}),mounted:function(){var e=this,t=window.SpeechRecognition||window.webkitSpeechRecognition;this.recognition=new t,this.recognition.interimResults=!0,this.recognition.lang="en-US",this.ws=new WebSocket("wss://"+window.location.host+"/wss"),this.ws.addEventListener("message",(function(t){var n=JSON.parse(t.data);"modification"===n.type?e.content=n.message:"sentence"===n.type&&e.sentences.push({sender:n.username,content:n.message,time:n.timestamp})}))}}),_e=Se,Ve=(n("90fc"),Object(u["a"])(_e,we,ye,!1,null,null,null)),Oe=Ve.exports;m()(Ve,{VBtn:f["a"],VContainer:b["a"],VIcon:w["a"],VRow:re["a"],VTextField:ie["a"]}),s["a"].use(M["a"]);var Te=[{path:"/",component:be,name:"login"},{path:"/chat",component:ce,name:"chat"},{path:"/text",component:Oe,name:"text"}],je=new M["a"]({mode:"history",routes:Te}),Ue=je,Ee={namespaced:!0,state:{currentUser:null},getters:{getCurrentUser:function(e){return e.currentUser}},mutations:{setCurrentUser:function(e,t){e.currentUser=t}},actions:{}},Ae=n("2909"),Le=(n("99af"),{namespaced:!0,state:{userList:[]},getters:{getUserList:function(e){return e.userList}},mutations:{addUserToUserList:function(e,t){e.userList=[].concat(Object(Ae["a"])(e.userList),[t])}},actions:{}}),Re={namespaced:!0,state:{messagesList:[]},getters:{getMessagesList:function(e){return e.messagesList}},mutations:{addMessagesToMessagesList:function(e,t){e.messagesList=[].concat(Object(Ae["a"])(e.messagesList),[t])}},actions:{}},Be={namespaced:!0,state:{currentText:null,textHistory:[]},getters:{getCurrentText:function(e){return e.currentText}},mutations:{addTextToHistory:function(e,t){e.textHistory=[].concat(Object(Ae["a"])(e.textHistory),[t])},setCurrentText:function(e,t){e.setCurrentText=t}},actions:{}};s["a"].use(ee["a"]);var Ne=function(){return new ee["a"].Store({modules:{auth:Ee,user:Le,message:Re,text:Be}})},Me=Ne,qe=n("28dd");s["a"].use(ee["a"]),s["a"].use(qe["a"]),new s["a"]({vuetify:N,router:Ue,store:Me,render:function(e){return e(R)}}).$mount("#app")},"90fc":function(e,t,n){"use strict";n("9c70")},"9c70":function(e,t,n){}});
//# sourceMappingURL=app.254388ed.js.map